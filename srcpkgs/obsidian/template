# Template file for 'obsidian'
pkgname=obsidian
version=1.9.14
revision=1
archs="x86_64"
hostmakedepends="tar"
short_desc="A powerful knowledge base that works on top of a local folder of plain text Markdown files."
maintainer="Rickard <@>"
license="custom:Commercial"
homepage="https://github.com/obsidianmd/obsidian-releases"
distfiles="https://github.com/obsidianmd/obsidian-releases/releases/download/v${version}/obsidian-${version}.tar.gz"
checksum=ba364e8efb8578d4e4229ff507395b7539f4c79c35324ea64883d245f490be6f

do_install() {
  install -dm755 "${DESTDIR}/opt/${pkgname}" "${DESTDIR}/usr/bin" "${DESTDIR}/usr/share/applications" "${DESTDIR}/usr/share/pixmaps"

  vinstall "${FILESDIR}/obsidian.desktop" 644 usr/share/applications/

  vcopy * "opt/${pkgname}"

  ln -sf /opt/${pkgname}/obsidian "${DESTDIR}/usr/bin/obsidian"

  vinstall "${FILESDIR}/icons/obsidian48.png" 0644 usr/share/pixmaps "${pkgname}.png"
  for size in 16 32 48 64 128 256 512; do
    install -d ${DESTDIR}/usr/share/icons/hicolor/${size}x${size}/apps
    vinstall "${FILESDIR}/icons/obsidian${size}.png" 0644 usr/share/icons/hicolor/${size}x${size}/apps obsidian.png
  done
}

post_install() {
  vlicense LICENSE.electron.txt
  vlicense LICENSES.chromium.html
}
