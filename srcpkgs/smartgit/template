# Template file for 'smartgit'
pkgname=smartgit
version=24.1.5
revision=1
_tarver=24_1_5
archs="x86_64"
depends="desktop-file-utils gtk+3 which git git-lfs openjdk21"
short_desc="Graphical Git client"
maintainer="mobinmob <mobinmob@disroot.org>"
license="custom:proprietary"
homepage="https://www.syntevo.com/smartgit/"
changelog="https://www.syntevo.com/smartgit/changelog.txt"
distfiles="https://www.syntevo.com/downloads/smartgit/smartgit-linux-${_tarver}.tar.gz"
checksum=62ab9e4dbc00f4a7171091b94de5a43f3ccdc809e7250d7e55062ca99292dbf2
nopie=yes
# nostrip=yes
python_version=3

do_install() {
    # Install licenses
    vinstall -d -m 755 "${DESTDIR}/usr/share/licenses/${pkgname}"
    mv "${pkgname}/licenses"/* "${DESTDIR}/usr/share/licenses/${pkgname}"
    ln -s /opt/${pkgname}/license.html "${DESTDIR}/usr/share/licenses/${pkgname}"
    rmdir "${pkgname}/licenses"
    # Install application files
    vinstall -d -m 755 "${DESTDIR}/opt"
    mv "${pkgname}" "${DESTDIR}/opt/${pkgname}"
    # Install desktop file
    vinstall -D -m 644 "${pkgname}.desktop" "${DESTDIR}/usr/share/applications/${pkgname}.desktop"
    # Install icon files
    vinstall -d -m 755 "${DESTDIR}/usr/share/icons/hicolor"
    cd "${DESTDIR}/usr/share/icons/hicolor"
    for _size in 32 48 64 128 256
    do
        vinstall -d "${_size}x${_size}/apps"
        ln -s "/opt/${pkgname}/bin/smartgit-${_size}.png" "${_size}x${_size}/apps/${pkgname}.png"
    done
    # Add symlink to /usr/bin
    chmod 755 "${DESTDIR}/opt/${pkgname}/bin/smartgit.sh"
    vinstall -d -m 755 "${DESTDIR}/usr/bin"
    ln -s "/opt/${pkgname}/bin/smartgit.sh" "${DESTDIR}/usr/bin/${pkgname}"
}
